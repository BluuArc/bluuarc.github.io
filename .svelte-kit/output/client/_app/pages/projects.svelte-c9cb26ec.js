import{S as e,i as t,s as a,e as n,k as r,t as l,c as o,a as s,n as i,g as c,d as u,b as f,f as g,E as h,V as p,h as d,G as v,N as m,Y as $,Z as b,H as E,I as P,j,m as y,_ as T,o as _,$ as k,J as L,v as D,r as O,w as F,W as S,a0 as x,z as A,K as C,M as w,L as N,a1 as I}from"../chunks/vendor-df840aab.js";import{d as W}from"../chunks/singletonGetters-ff01b479.js";import{g as U,P as H}from"../chunks/ProjectList-edfcb33f.js";import{g as B}from"../chunks/DateTime-99aa3d5e.js";var G,R,M,V;function q(){return[{label:"Last Commit Date",value:M.LastCommitDate,filterFunction:(e,t,a)=>new Date(e.lastPushedAt).valueOf()-new Date(t.lastPushedAt).valueOf()*a},{label:"Alphabetical",value:M.Alphabetical,filterFunction:(e,t,a)=>e.name.toLocaleLowerCase().localeCompare(t.name.toLocaleLowerCase())*a},{label:"Creation Date",value:M.CreationDate,filterFunction:(e,t,a)=>new Date(e.createdAt).valueOf()-new Date(t.createdAt).valueOf()*a}]}(R=G||(G={}))[R.TrueOrFalse=0]="TrueOrFalse",R[R.True=1]="True",R[R.False=2]="False",(V=M||(M={})).LastCommitDate="lastCommitDate",V.Alphabetical="alphabetical",V.CreationDate="creationDate";const z=[function(e,{name:t}){let a=!t;return a||(a=e.name.toLowerCase().includes(t)),a},function(e,{languages:t}){let a=0===t.length;return a||(a=t.some((t=>e.languages.some((e=>e.name===t))))),a},function(e,{authors:t}){let a=0===t.length;return a||(a=t.some((t=>e.owner===t))),a},function(e,{projectPageExistenceFilter:t}){let a=0===t;if(!a){const n=!!e.homepageURL;a=1===t&&n||2===t&&!n}return a},function(e,{packageExistenceFilter:t}){let a=0===t;if(!a){const n=e.packages.totalCount>0;a=1===t&&n||2===t&&!n}return a},function(e,{deploymentExistenceFilter:t}){let a=0===t;if(!a){const n=e.deployments.totalCount>0;a=1===t&&n||2===t&&!n}return a}];function J(e,t){const a=function(e,t){const a=q(),n=a.find((t=>t.value===e))||a.find((e=>e.value===M.Alphabetical));return(e,a)=>n.filterFunction(e,a,t)}(t.sortType,t.sortDirection);return e.filter((e=>z.every((a=>a(e,t))))).sort(a)}function K(){return{name:"",languages:[],authors:[],projectPageExistenceFilter:0,packageExistenceFilter:0,deploymentExistenceFilter:0,sortType:M.LastCommitDate,sortDirection:-1}}function Y(e){const t=new URLSearchParams,a=K();return Object.keys(a).forEach((n=>{const r=a[n],l=e[n];let o=!1;Array.isArray(r)?o=Array.isArray(l)&&!function(e,t,a=((e,t)=>e===t)){let n=e.length===t.length;return n&&(n=e.every((e=>t.some((t=>a(e,t)))))),n}(r,l):"object"!=typeof l&&(o=r!==l),o&&t.set(n,l)})),t}function Z(e,t,a){const n=e.slice();return n[5]=t[a],n}function Q(e){let t,a,v,m,$,b,E,P,j=e[5].label+"";return{c(){t=n("label"),a=n("input"),m=r(),$=l(j),b=r(),this.h()},l(e){t=o(e,"LABEL",{});var n=s(t);a=o(n,"INPUT",{type:!0,value:!0}),m=i(n),$=c(n,j),b=i(n),n.forEach(u),this.h()},h(){f(a,"type","checkbox"),a.__value=v=e[5].value,a.value=a.__value,e[4][0].push(a)},m(n,r){g(n,t,r),h(t,a),a.checked=~e[0].indexOf(a.__value),h(t,m),h(t,$),h(t,b),E||(P=p(a,"change",e[3]),E=!0)},p(e,t){2&t&&v!==(v=e[5].value)&&(a.__value=v,a.value=a.__value),1&t&&(a.checked=~e[0].indexOf(a.__value)),2&t&&j!==(j=e[5].label+"")&&d($,j)},d(n){n&&u(t),e[4][0].splice(e[4][0].indexOf(a),1),E=!1,P()}}}function X(e){let t,a,f,p,$=e[1],b=[];for(let n=0;n<$.length;n+=1)b[n]=Q(Z(e,$,n));return{c(){t=n("fieldset"),a=n("legend"),f=l(e[2]),p=r();for(let e=0;e<b.length;e+=1)b[e].c()},l(n){t=o(n,"FIELDSET",{});var r=s(t);a=o(r,"LEGEND",{});var l=s(a);f=c(l,e[2]),l.forEach(u),p=i(r);for(let e=0;e<b.length;e+=1)b[e].l(r);r.forEach(u)},m(e,n){g(e,t,n),h(t,a),h(a,f),h(t,p);for(let a=0;a<b.length;a+=1)b[a].m(t,null)},p(e,[a]){if(4&a&&d(f,e[2]),3&a){let n;for($=e[1],n=0;n<$.length;n+=1){const r=Z(e,$,n);b[n]?b[n].p(r,a):(b[n]=Q(r),b[n].c(),b[n].m(t,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=$.length}},i:v,o:v,d(e){e&&u(t),m(b,e)}}}function ee(e,t,a){let{options:n=[]}=t,{groupTitle:r=""}=t,{value:l=[]}=t;const o=[[]];return e.$$set=e=>{"options"in e&&a(1,n=e.options),"groupTitle"in e&&a(2,r=e.groupTitle),"value"in e&&a(0,l=e.value)},[l,n,r,function(){l=$(o[0],this.__value,this.checked),a(0,l)},o]}class te extends e{constructor(e){super(),t(this,e,ee,X,a,{options:1,groupTitle:2,value:0})}}function ae(e,t,a){const n=e.slice();return n[5]=t[a],n}function ne(e){let t,a,v,m,$,b,E,P,j=e[5].label+"";return{c(){t=n("label"),a=n("input"),m=r(),$=l(j),b=r(),this.h()},l(e){t=o(e,"LABEL",{});var n=s(t);a=o(n,"INPUT",{type:!0,value:!0}),m=i(n),$=c(n,j),b=i(n),n.forEach(u),this.h()},h(){f(a,"type","radio"),a.__value=v=e[5].value,a.value=a.__value,e[4][0].push(a)},m(n,r){g(n,t,r),h(t,a),a.checked=a.__value===e[0],h(t,m),h(t,$),h(t,b),E||(P=p(a,"change",e[3]),E=!0)},p(e,t){2&t&&v!==(v=e[5].value)&&(a.__value=v,a.value=a.__value),1&t&&(a.checked=a.__value===e[0]),2&t&&j!==(j=e[5].label+"")&&d($,j)},d(n){n&&u(t),e[4][0].splice(e[4][0].indexOf(a),1),E=!1,P()}}}function re(e){let t,a,f,p,$=e[1],b=[];for(let n=0;n<$.length;n+=1)b[n]=ne(ae(e,$,n));return{c(){t=n("fieldset"),a=n("legend"),f=l(e[2]),p=r();for(let e=0;e<b.length;e+=1)b[e].c()},l(n){t=o(n,"FIELDSET",{});var r=s(t);a=o(r,"LEGEND",{});var l=s(a);f=c(l,e[2]),l.forEach(u),p=i(r);for(let e=0;e<b.length;e+=1)b[e].l(r);r.forEach(u)},m(e,n){g(e,t,n),h(t,a),h(a,f),h(t,p);for(let a=0;a<b.length;a+=1)b[a].m(t,null)},p(e,[a]){if(4&a&&d(f,e[2]),3&a){let n;for($=e[1],n=0;n<$.length;n+=1){const r=ae(e,$,n);b[n]?b[n].p(r,a):(b[n]=ne(r),b[n].c(),b[n].m(t,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=$.length}},i:v,o:v,d(e){e&&u(t),m(b,e)}}}function le(e,t,a){let{options:n=[]}=t,{groupTitle:r=""}=t,{value:l=null}=t;return e.$$set=e=>{"options"in e&&a(1,n=e.options),"groupTitle"in e&&a(2,r=e.groupTitle),"value"in e&&a(0,l=e.value)},[l,n,r,function(){l=this.__value,a(0,l)},[[]]]}class oe extends e{constructor(e){super(),t(this,e,le,re,a,{options:1,groupTitle:2,value:0})}}const se={subscribe:e=>(()=>{const e=b("__svelte__");return{page:{subscribe:e.page.subscribe},navigating:{subscribe:e.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:e.navigating.subscribe}},session:e.session}})().page.subscribe(e)};function ie(e){let t,a,d,v,m,$,b,x,A,C,w,N,I,W,U,H,B,G,R,M,V,q,z,J,K,Y,Z,Q,X,ee,ae,ne,re,le,se,ie,ce,ue,fe,ge,he,pe,de,ve,me;function $e(t){e[21](t)}let be={groupTitle:"Languages",options:e[2]};function Ee(t){e[22](t)}void 0!==e[4]&&(be.value=e[4]),H=new te({props:be}),E.push((()=>P(H,"value",$e)));let Pe={groupTitle:"Authors",options:e[3]};function je(t){e[23](t)}void 0!==e[5]&&(Pe.value=e[5]),R=new te({props:Pe}),E.push((()=>P(R,"value",Ee)));let ye={groupTitle:"Project Page",options:e[11]};function Te(t){e[24](t)}void 0!==e[6]&&(ye.value=e[6]),q=new oe({props:ye}),E.push((()=>P(q,"value",je)));let _e={groupTitle:"Packages",options:e[12]};function ke(t){e[25](t)}void 0!==e[7]&&(_e.value=e[7]),K=new oe({props:_e}),E.push((()=>P(K,"value",Te)));let Le={groupTitle:"Deployments",options:e[13]};function De(t){e[26](t)}void 0!==e[8]&&(Le.value=e[8]),Q=new oe({props:Le}),E.push((()=>P(Q,"value",ke)));let Oe={groupTitle:"Type",options:e[14]};function Fe(t){e[27](t)}void 0!==e[9]&&(Oe.value=e[9]),se=new oe({props:Oe}),E.push((()=>P(se,"value",De)));let Se={groupTitle:"Direction",options:e[15]};return void 0!==e[10]&&(Se.value=e[10]),ue=new oe({props:Se}),E.push((()=>P(ue,"value",Fe))),{c(){t=n("section"),a=n("form"),d=n("h2"),v=l("Search Projects"),m=r(),$=n("div"),b=n("label"),x=l("Name:"),A=r(),C=n("input"),w=r(),N=n("section"),I=n("h3"),W=l("Additional Filters"),U=r(),j(H.$$.fragment),G=r(),j(R.$$.fragment),V=r(),j(q.$$.fragment),J=r(),j(K.$$.fragment),Z=r(),j(Q.$$.fragment),ee=r(),ae=n("section"),ne=n("h3"),re=l("Sorts"),le=r(),j(se.$$.fragment),ce=r(),j(ue.$$.fragment),ge=r(),he=n("button"),pe=l("Search"),this.h()},l(e){t=o(e,"SECTION",{});var n=s(t);a=o(n,"FORM",{});var r=s(a);d=o(r,"H2",{});var l=s(d);v=c(l,"Search Projects"),l.forEach(u),m=i(r),$=o(r,"DIV",{});var f=s($);b=o(f,"LABEL",{for:!0});var g=s(b);x=c(g,"Name:"),g.forEach(u),A=i(f),C=o(f,"INPUT",{type:!0,name:!0,id:!0,disabled:!0}),f.forEach(u),w=i(r),N=o(r,"SECTION",{});var h=s(N);I=o(h,"H3",{});var p=s(I);W=c(p,"Additional Filters"),p.forEach(u),U=i(h),y(H.$$.fragment,h),G=i(h),y(R.$$.fragment,h),V=i(h),y(q.$$.fragment,h),J=i(h),y(K.$$.fragment,h),Z=i(h),y(Q.$$.fragment,h),h.forEach(u),ee=i(r),ae=o(r,"SECTION",{});var E=s(ae);ne=o(E,"H3",{});var P=s(ne);re=c(P,"Sorts"),P.forEach(u),le=i(E),y(se.$$.fragment,E),ce=i(E),y(ue.$$.fragment,E),E.forEach(u),ge=i(r),he=o(r,"BUTTON",{type:!0,disabled:!0});var j=s(he);pe=c(j,"Search"),j.forEach(u),r.forEach(u),n.forEach(u),this.h()},h(){f(b,"for","name"),f(C,"type","text"),f(C,"name","name"),f(C,"id","name"),C.disabled=e[0],f(he,"type","submit"),he.disabled=e[0]},m(n,r){g(n,t,r),h(t,a),h(a,d),h(d,v),h(a,m),h(a,$),h($,b),h(b,x),h($,A),h($,C),T(C,e[1]),h(a,w),h(a,N),h(N,I),h(I,W),h(N,U),_(H,N,null),h(N,G),_(R,N,null),h(N,V),_(q,N,null),h(N,J),_(K,N,null),h(N,Z),_(Q,N,null),h(a,ee),h(a,ae),h(ae,ne),h(ne,re),h(ae,le),_(se,ae,null),h(ae,ce),_(ue,ae,null),h(a,ge),h(a,he),h(he,pe),de=!0,ve||(me=[p(C,"input",e[20]),p(a,"submit",k(e[16]))],ve=!0)},p(e,t){(!de||1&t[0])&&(C.disabled=e[0]),2&t[0]&&C.value!==e[1]&&T(C,e[1]);const a={};4&t[0]&&(a.options=e[2]),!B&&16&t[0]&&(B=!0,a.value=e[4],L((()=>B=!1))),H.$set(a);const n={};8&t[0]&&(n.options=e[3]),!M&&32&t[0]&&(M=!0,n.value=e[5],L((()=>M=!1))),R.$set(n);const r={};!z&&64&t[0]&&(z=!0,r.value=e[6],L((()=>z=!1))),q.$set(r);const l={};!Y&&128&t[0]&&(Y=!0,l.value=e[7],L((()=>Y=!1))),K.$set(l);const o={};!X&&256&t[0]&&(X=!0,o.value=e[8],L((()=>X=!1))),Q.$set(o);const s={};!ie&&512&t[0]&&(ie=!0,s.value=e[9],L((()=>ie=!1))),se.$set(s);const i={};!fe&&1024&t[0]&&(fe=!0,i.value=e[10],L((()=>fe=!1))),ue.$set(i),(!de||1&t[0])&&(he.disabled=e[0])},i(e){de||(D(H.$$.fragment,e),D(R.$$.fragment,e),D(q.$$.fragment,e),D(K.$$.fragment,e),D(Q.$$.fragment,e),D(se.$$.fragment,e),D(ue.$$.fragment,e),de=!0)},o(e){O(H.$$.fragment,e),O(R.$$.fragment,e),O(q.$$.fragment,e),O(K.$$.fragment,e),O(Q.$$.fragment,e),O(se.$$.fragment,e),O(ue.$$.fragment,e),de=!1},d(e){e&&u(t),F(H),F(R),F(q),F(K),F(Q),F(se),F(ue),ve=!1,S(me)}}}const ce=B("SearchSection");function ue(e){return e.map((e=>({label:e,value:e})))}function fe(e,t,a){let{disabled:n=!1}=t,{languages:r=[]}=t,{authors:l=[]}=t,{allProjects:o=[]}=t;const s=x(),i=[{label:"With or Without Project Page",value:0},{label:"Only With Project Page",value:1},{label:"Only Without Project Page",value:2}],c=[{label:"With or Without Packages",value:0},{label:"Only With Packages",value:1},{label:"Only Without Packages",value:2}],u=[{label:"With or Without Deployments",value:0},{label:"Only With Deployments",value:1},{label:"Only Without Deployments",value:2}],f=q(),g=[{label:"Ascending",value:1},{label:"Descending",value:-1}];let h="",p=[],d=[],v=[],m=[],$=0,b=0,E=0,P=M.LastCommitDate,j=-1;function y(){return{name:h,languages:v,authors:m,projectPageExistenceFilter:$,packageExistenceFilter:b,deploymentExistenceFilter:E,sortType:P,sortDirection:j}}function T(){const e=y();ce.debug(e);const t=J(o,y());ce.debug({filteredProjects:t}),s("filterchange",{filteredProjects:t,filters:e})}let _=null,k=!1;function L(){if(_){const e=_.toString(),t=Y(y()).toString();if(e!==t){const n=function(e){const t=K();return e.forEach(((e,a)=>{const n=t[a];Array.isArray(n)?t[a]=e.split(","):t[a]="number"==typeof n?+e:e})),t}(_);ce.debug("applying filters from params",{params:e,filters:n,urlFromCurrentFilters:t}),function(e){a(1,h=e.name),a(4,v=e.languages.filter((e=>p.find((t=>t.value===e))))),a(5,m=e.authors.filter((e=>d.find((t=>t.value===e))))),a(6,$=e.projectPageExistenceFilter),a(7,b=e.packageExistenceFilter),a(8,E=e.deploymentExistenceFilter),a(9,P=e.sortType),a(10,j=e.sortDirection)}(n),T()}}}return se.subscribe((({query:e})=>{_=e,k&&L()})),A((()=>{L(),k=!0})),e.$$set=e=>{"disabled"in e&&a(0,n=e.disabled),"languages"in e&&a(17,r=e.languages),"authors"in e&&a(18,l=e.authors),"allProjects"in e&&a(19,o=e.allProjects)},e.$$.update=()=>{393216&e.$$.dirty[0]&&(a(2,p=ue(r)),a(3,d=ue(l)))},[n,h,p,d,v,m,$,b,E,P,j,i,c,u,f,g,T,r,l,o,function(){h=this.value,a(1,h)},function(e){v=e,a(4,v)},function(e){m=e,a(5,m)},function(e){$=e,a(6,$)},function(e){b=e,a(7,b)},function(e){E=e,a(8,E)},function(e){P=e,a(9,P)},function(e){j=e,a(10,j)}]}class ge extends e{constructor(e){super(),t(this,e,fe,ie,a,{disabled:0,languages:17,authors:18,allProjects:19},[-1,-1])}}const{document:he}=I;function pe(e){let t,a,f,p,d,m,$=e[6].message+"";return{c(){t=n("section"),a=n("p"),f=l("An error occurred loading the project data."),p=r(),d=n("p"),m=l($)},l(e){t=o(e,"SECTION",{});var n=s(t);a=o(n,"P",{});var r=s(a);f=c(r,"An error occurred loading the project data."),r.forEach(u),p=i(n),d=o(n,"P",{});var l=s(d);m=c(l,$),l.forEach(u),n.forEach(u)},m(e,n){g(e,t,n),h(t,a),h(a,f),h(t,p),h(t,d),h(d,m)},p:v,i:v,o:v,d(e){e&&u(t)}}}function de(e){let t,a,f,p,d,v,m,$;return t=new ge({props:{disabled:e[1],authors:e[5].authors,languages:e[5].languages,allProjects:e[5].allProjects}}),t.$on("filterchange",e[3]),m=new H({props:{projects:e[0],projectHeaderLevel:3}}),{c(){j(t.$$.fragment),a=r(),f=n("section"),p=n("h2"),d=l("Project List"),v=r(),j(m.$$.fragment)},l(e){y(t.$$.fragment,e),a=i(e),f=o(e,"SECTION",{});var n=s(f);p=o(n,"H2",{});var r=s(p);d=c(r,"Project List"),r.forEach(u),v=i(n),y(m.$$.fragment,n),n.forEach(u)},m(e,n){_(t,e,n),g(e,a,n),g(e,f,n),h(f,p),h(p,d),h(f,v),_(m,f,null),$=!0},p(e,a){const n={};2&a&&(n.disabled=e[1]),t.$set(n);const r={};1&a&&(r.projects=e[0]),m.$set(r)},i(e){$||(D(t.$$.fragment,e),D(m.$$.fragment,e),$=!0)},o(e){O(t.$$.fragment,e),O(m.$$.fragment,e),$=!1},d(e){F(t,e),e&&u(a),e&&u(f),F(m)}}}function ve(e){let t,a,r;return{c(){t=n("section"),a=n("p"),r=l("Loading project data...")},l(e){t=o(e,"SECTION",{});var n=s(t);a=o(n,"P",{});var l=s(a);r=c(l,"Loading project data..."),l.forEach(u),n.forEach(u)},m(e,n){g(e,t,n),h(t,a),h(a,r)},p:v,i:v,o:v,d(e){e&&u(t)}}}function me(e){let t,a,p,d,v,m,$={ctx:e,current:null,token:null,hasCatch:!0,pending:ve,then:de,catch:pe,value:5,error:6,blocks:[,,,]};return C(e[2],$),{c(){t=r(),a=n("main"),p=n("h1"),d=l("Projects Page"),v=r(),$.block.c(),this.h()},l(e){w('[data-svelte="svelte-h5k7g7"]',he.head).forEach(u),t=i(e),a=o(e,"MAIN",{});var n=s(a);p=o(n,"H1",{class:!0});var r=s(p);d=c(r,"Projects Page"),r.forEach(u),v=i(n),$.block.l(n),n.forEach(u),this.h()},h(){he.title="Projects Page | joshuacastor.me",f(p,"class","sr-only")},m(e,n){g(e,t,n),g(e,a,n),h(a,p),h(p,d),h(a,v),$.block.m(a,$.anchor=null),$.mount=()=>a,$.anchor=null,m=!0},p(t,[a]){N($,e=t,a)},i(e){m||(D($.block),m=!0)},o(e){for(let t=0;t<3;t+=1){const e=$.blocks[t];O(e)}m=!1},d(e){e&&u(t),e&&u(a),$.block.d(),$.token=null,$=null}}}function $e(e){return W(e)}function be(e,t,a){let n=[],r=!0;const l=B("ProjectsPage"),o=U().then((e=>{a(0,n=Object.values(e.projects)),a(1,r=!1);return{languages:e.overall.languages.map((e=>e.name)),authors:e.overall.ownership.map((e=>e.name)),allProjects:Object.values(e.projects)}})).catch((e=>(l.error(e),a(1,r=!1),{languages:[],authors:[],allProjects:[]})));return[n,r,o,function(e){if(e&&e.detail&&Array.isArray(e.detail.filteredProjects)?a(0,n=e.detail.filteredProjects.slice()):l.warn("no filtered projects found in filterchange event",e),e&&e.detail&&e.detail.filters){const t=Y(e.detail.filters).toString(),a=new URLSearchParams(location.href.slice(location.href.indexOf("?")+1)).toString();if(t!==a){const e=`projects?${t}`;l.debug("filter navigation url",{url:e,currentUrlParamsString:a}),history.pushState({url:e},document.title,e)}else l.debug("skipping push state due to params being identical",{urlParamsString:t,currentUrlParamsString:a})}}]}export default class extends e{constructor(e){super(),t(this,e,be,me,a,{})}}export{$e as load};
